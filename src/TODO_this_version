--------------------------------------------------
--------------top bar menu----------

*en alguna ocasión no se desactiva topbar, se queda siempre visible aunque estemos en el Basic y con el foco ahí.
->quizá es culpa del autoframeskip?

*menus de topbar deben salir con traducción también? aunque ocupará mas caracteres...

----------Fin top bar menu----------
----------------------------------------


-Agregar ¿todas? las entradas de menus de indexación, llamando a menu_add_item_menu_index_full_path, ejemplo:
        menu_add_item_menu_index_full_path(array_menu_settings_debug,
            "Main Menu-> Settings-> Debug","Menú Principal-> Opciones-> Debug","Menú Principal-> Opcions-> Debug");
Los menus que no usen menu_add_item_menu_index_full_path se les genera automáticamente, si se han abierto desde Main Menu se le agrega ese prefijo,
pero otros que vienen por ejemplo desde Top Menu o desde Top Buttons pues no

-Juego de la vida que tenga ayuda con las reglas del juego. O ya lo tiene?


-Si conmuto de un CPU step a ventana abierta de hexedit, ejecutará alguna instrucción sin querer?
Y teniendo el stop emulation on menú? Se ejecuta alguna instrucción sin querer?


-algun tipo de build que no sea ni linux ni mac ni windows, sino simplemente UNIX_GENERIC o algo similar
Probar mas sistemas unix alternativos



-Ayuda para algunos tipos de iconos o acciones, como send keys menú: send keys por ejemplo tiene el caracter "@" que indica tecla ESC

ok -sendkeys menu poder simular envio ESC para hacer que se cierre el menu
->ok con "@"

-Para Minix:
curses enlazar contra -lcurses y no -lncurses
Poder definir otra tecla para abrir el menu, F5 lanza comandos del sistema
Por ejemplo en driver curses defino tecla END como si fuera F5
Parece que curses no tiene soporte para eventos de ratón
setting para compilar con clang


-lightgun
*rutina de Sinclair Action Pack - Side A, del programa principal que detecta posicion y, ponerla como ejempo
en programa aparte, mostrando coordenada y en pantalla
*emulación de otros sistemas opticos, como TROJAN LIGHT PEN (PRO ZX 128 + 2A / 3 +). Ver documento en extras



-config setting para aymidi_rs232_enabled.v
if (MACHINE_IS_SPECTRUM) nuevo_aymidi_rs232_handle(value); esto no tendria que ser dependiente de ese setting?
desactivado por defecto
con operation wolf de la magnum escribe muchos mensajes en consola (paranoid) aun desactivando el settting.
Es necesario tanto print?


-poder hacer que con menu abierto, se envien eventos de teclado, pistola etc a máquina emulada.
Util si estamos en debug cpu y queremos que un juego lea el boton del ratón (emulando lightgun) y/o luz de pistola
Quizá con una opción y sólo si está el foco en ventana de debug CPU



-revisar los salir_todos_menus=1 que se puedan cambiar por   menu_add_item_menu_se_cerrara( en el item de menu

-icono para snapshots in ram. Poder guardar snap en ram manualmente, no solo a intervalos.
quiza icono ramdisk que englobe snapshots y otras cosas

-snapshots en ram
*icono para browse snapshots. mejorarlo
*icono para guardar snapshot. mejorarlo

-Soportar uft-8 en el footer, que sirva para texto footer normal pero tambien con opciones de --programsettingsinfo de archivos .config.
*testear con --programname

------

- Cambio rutinas video ZX80/81: hsync_generator_active.v no se usaba para nada
Y tiempos para hsync y nmi se basan en t-estados y en alterar t-estados artificialmente, esto no es correcto

-view variables interfiere en render!! con breakout por ejemplo
-revisar tscaline_draw_timeout para que funcione modo fast en negro, con modo no-realvideo
-franjas grabacion save no aparecen bien. probablemente por gestion de hsync timeout o vsync timeout
si se activa simular vsync, se ven franjas de grabacion
quiza es que al grabar, la señal de vsync "artificial" (generada de sacar los 0/1 al casette) no es correcta y por eso no engancha vsync nunca
-tiene sentido simulate_lost_hsync?

Info video:

https://quix.us/timex/rigter/ZX@20Video@20Tutorial.html


VSYNC es realmente secuencia de señal vsync + pulsos hsync. como envia esto el ZX81 realmente?
Parece que durante vsync no envia hsync, como se deberia esperar


-Ver rom rutinas nmi y tiempos
http://blog.tynemouthsoftware.co.uk/2023/10/how-the-zx81-generates-video.html
/Wait is also pulled low, to ensure the Z80 is in the correct T-State when the NMI is serviced.
This is gated by the /Halt signal, which would always be high as that is normally triggered by processing
the End of Line character, which will not happen on the non-visible lines.


https://k1.spdns.de/Vintage/Sinclair/80/Sinclair%20ZX81/ROMs/zx81%20version%202%20%27improved%27%20rom%20source.htm
En especial:

HALT                    ; (1) HALT synchronizes with NMI.
; Used with special hardware connected to the
; Z80 HALT and WAIT lines to take 1 clock cycle.


->le pongo que cada halt tarde 1 t-estado cuando se ha lanzado nmi

-Modo FAST del ZX81 no se ve bien

---

-Ajustar menu settings->TV para al menos una opción? O que no salga si la máquina emulada no tiene opciones
-Meter ajustes de TV (hsync internal frequency-para timeout, vsync internal frequency-para timeout) y otros, en menú settings-Tv

Estado video zx81:
-modo fast: error
-juegos sin efectos hires: ok
-wrx: ok
-chrs128: ok
-hrg: ok
-udg: ok. aunque interc-u.o raro al principio. quizá usa fast?
-pseudo hi res: manic mal. pacman en el juego mal. tetrishr mal

-nolimits.81: inicio mal. posiblemente use combinacion de fast
-sllc.81: falta un scanline de cada char?
