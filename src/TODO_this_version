--------------------------------------------------
--------------top bar menu----------

*en alguna ocasión no se desactiva topbar, se queda siempre visible aunque estemos en el Basic y con el foco ahí.
->quizá es culpa del autoframeskip?

*menus de topbar deben salir con traducción también? aunque ocupará mas caracteres...

----------Fin top bar menu----------
----------------------------------------


-Agregar ¿todas? las entradas de menus de indexación, llamando a menu_add_item_menu_index_full_path, ejemplo:
        menu_add_item_menu_index_full_path(array_menu_settings_debug,
            "Main Menu-> Settings-> Debug","Menú Principal-> Opciones-> Debug","Menú Principal-> Opcions-> Debug");
Los menus que no usen menu_add_item_menu_index_full_path se les genera automáticamente, si se han abierto desde Main Menu se le agrega ese prefijo,
pero otros que vienen por ejemplo desde Top Menu o desde Top Buttons pues no

-Juego de la vida que tenga ayuda con las reglas del juego. O ya lo tiene?


-Si conmuto de un CPU step a ventana abierta de hexedit, ejecutará alguna instrucción sin querer?
Y teniendo el stop emulation on menú? Se ejecuta alguna instrucción sin querer?


-algun tipo de build que no sea ni linux ni mac ni windows, sino simplemente UNIX_GENERIC o algo similar
Probar mas sistemas unix alternativos



-Ayuda para algunos tipos de iconos o acciones, como send keys menú: send keys por ejemplo tiene el caracter "@" que indica tecla ESC

ok -sendkeys menu poder simular envio ESC para hacer que se cierre el menu
->ok con "@"

-Para Minix:
curses enlazar contra -lcurses y no -lncurses
Poder definir otra tecla para abrir el menu, F5 lanza comandos del sistema
Por ejemplo en driver curses defino tecla END como si fuera F5
Parece que curses no tiene soporte para eventos de ratón
setting para compilar con clang


-lightgun
*rutina de Sinclair Action Pack - Side A, del programa principal que detecta posicion y, ponerla como ejempo
en programa aparte, mostrando coordenada y en pantalla
*emulación de otros sistemas opticos, como TROJAN LIGHT PEN (PRO ZX 128 + 2A / 3 +). Ver documento en extras

ok-lightgun: magnum. poder tener margen de mas de 1 scanline (para el acid killer por ejemplo)
-magnun: acid killer, ver por que no funciona en mitad derecha

-config setting para aymidi_rs232_enabled.v
if (MACHINE_IS_SPECTRUM) nuevo_aymidi_rs232_handle(value); esto no tendria que ser dependiente de ese setting?
desactivado por defecto
con operation wolf de la magnum escribe muchos mensajes en consola (paranoid) aun desactivando el settting.
Es necesario tanto print?


-poder hacer que con menu abierto, se envien eventos de teclado, pistola etc a máquina emulada.
Util si estamos en debug cpu y queremos que un juego lea el boton del ratón (emulando lightgun) y/o luz de pistola
Quizá con una opción y sólo si está el foco en ventana de debug CPU



-revisar los salir_todos_menus=1 que se puedan cambiar por   menu_add_item_menu_se_cerrara( en el item de menu

-icono para snapshots in ram. Poder guardar snap en ram manualmente, no solo a intervalos.
quiza icono ramdisk que englobe snapshots y otras cosas

-snapshots en ram
*icono para browse snapshots. mejorarlo
*icono para guardar snapshot. mejorarlo

-Soportar uft-8 en el footer, que sirva para texto footer normal pero tambien con opciones de --programsettingsinfo de archivos .config.
*testear con --programname

- Smartload history file: que se guarde en un archivo las rutas de todos los archivos cargados. Me sirve para confeccionar una lista de los juegos a testear en las pruebas de video de ZX80 y ZX81

- Poder ver todos los sprites de tbblue, MSX etc de golpe, en una sola ventana

- Poder ver los t-estados que tarda una instrucción, en vista de debug cpu

-Acción de ESCMenu en joystick, cierra todos los menús? Quizá hay que crear una acción nueva que sea menú atrás... O sirve con mover a la izquierda?

-Opción para maximizar siempre una ventana al abrirla (cualquier ventana) y/o poder elegir qué ventanas maximizar
------

#####  Cambio rutinas video ZX80/81: hsync_generator_active.v no se usaba para nada
Y tiempos para hsync y nmi se basan en t-estados y en alterar t-estados artificialmente, esto no es correcto

-view variables interfiere en render!! con breakout por ejemplo
-revisar tscaline_draw_timeout para que funcione modo fast en negro, con modo no-realvideo
-franjas grabacion save no aparecen bien. probablemente por gestion de hsync timeout o vsync timeout
si se activa simular vsync, se ven franjas de grabacion
quiza es que al grabar, la señal de vsync "artificial" (generada de sacar los 0/1 al casette) no es correcta y por eso no engancha vsync nunca
-tiene sentido simulate_lost_hsync?

Info video:

https://quix.us/timex/rigter/ZX@20Video@20Tutorial.html

https://8bit-museum.de/heimcomputer-2/sinclair/sinclair-scans/scans-zx81-video-display-system/

http://blog.tynemouthsoftware.co.uk/2023/10/how-the-zx81-generates-video.html

http://www.fruitcake.plus.com/Sinclair/ZX80/FlickerFree/ZX80_DisplayMechanism.htm

http://searle.x10host.com/zx80/zx80nmiV3.html

https://k1.spdns.de/Vintage/Sinclair/80/Sinclair%20ZX81/ROMs/zx81%20version%202%20%27improved%27%20rom%20source.htm



-Disparo de interrupciones se debería hacer similar a zxsp, que se pueda hacer step :
*opcode
*si se activa nmi o maskable, que se ejecute en el siguiente step


-starfigh.81 creo que es muy sensible a timings, si la nmi tarda mas, va muy lento


-Revisar franjas de load y save
*video_zx8081_ula_video_output deberia ser algun parametro de la tv. algo como 0/1 por defecto cuando no hay señal de "sprites"
*vsync deberia tener un minimo. por debajo de ahi, no hacer sync, eso permite que las franjas ocupen toda la pantalla
ok? *orquesta,mazogs en pantalla inicial tiene parpadeo arriba y abajo


-revisar waitmap y activarlo en pausa nmi. o dejar el 9 tal cual. si no se usa, desactivar funciones de uso de waitmap (no estoy
seguro de que alguna vez se salga de rango y genere segfault)

-Revisar settings de config y custom file config de ZX80 y ZX81 que ya no se usen. Dejarlas como deprecated

-settings de TV agregar config settings

-para manic miner parece que minimo vsync interval 73% con algoritmo anterior. pacman, tetris, madjump, bipods.. parece que todos los pseudo hires mal con este setting
Probar tambien QS defenda (ZX80), space invaders 1k, HERO.81, orquesta, SAVE

ok agrego setting específico -aszmice rom no se ve bien, sincroniza mal en horizontal. en zx81 mal, en zx80 bien

-quitar prints de debug de codigo tv, zx8081.c, core_zx8081.c

-en settings de linea de comandos, separar en tv settings, video settings y Main window settings